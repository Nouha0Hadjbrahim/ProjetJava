<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import javafx.geometry.Pos?>
<?import javafx.scene.effect.*?>

<AnchorPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.ProfilController"
            prefWidth="900" prefHeight="600"
            stylesheets="@/styles/ProfilBack.css"
            style="-fx-background-color: linear-gradient(to bottom right, #f8f9fa, #e9ecef);">

    <!-- ScrollPane principal -->
    <ScrollPane fitToWidth="true" styleClass="main-scroll-pane" AnchorPane.topAnchor="0.0" 
                AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">
        <VBox alignment="TOP_CENTER" spacing="30" styleClass="main-container">
            <!-- En-tête -->
            <VBox alignment="CENTER" spacing="10" styleClass="header-section">
                <Label text="Mon Profil" styleClass="page-title"/>
                <Label text="Gérez vos informations personnelles" styleClass="page-subtitle"/>
            </VBox>

            <!-- Contenu profil -->
            <StackPane styleClass="profile-container" maxWidth="800">
                <effect>
                    <DropShadow radius="20" color="rgba(0,0,0,0.1)" offsetY="5"/>
                </effect>

                <HBox spacing="40" alignment="CENTER" styleClass="profile-content">
                    <!-- Colonne Photo -->
                    <VBox alignment="CENTER" spacing="20" styleClass="photo-section">
                        <StackPane styleClass="photo-container">
                            <!-- Photo de profil par défaut si aucune photo n'est sélectionnée -->
                            <ImageView fx:id="photoProfil" fitWidth="160" fitHeight="160" 
                                     styleClass="profile-photo">
                                <image>
                                    <Image url="@/assets/user.png"/>
                                </image>
                            </ImageView>
                            <!-- Bouton de modification avec icône -->
                            <StackPane styleClass="edit-photo-button" onMouseClicked="#handleBrowsePhoto"
                                     StackPane.alignment="BOTTOM_RIGHT">
                                <ImageView fx:id="editIcon" fitWidth="24" fitHeight="24">
                                    <image>
                                        <Image url="@/assets/icons/modifier.png"/>
                                    </image>
                                </ImageView>
                            </StackPane>
                        </StackPane>
                        <Label fx:id="labelNomPrenom" styleClass="user-name"/>
                    </VBox>

                    <!-- Séparateur vertical avec style -->
                    <Separator orientation="VERTICAL" styleClass="vertical-separator"/>

                    <!-- Colonne Formulaire -->
                    <VBox spacing="15" styleClass="form-section">
                        <!-- Informations personnelles -->
                        <Label text="Informations personnelles" styleClass="section-title"/>
                        
                        <VBox spacing="8">
                            <Label text="Nom" styleClass="field-label"/>
                            <TextField fx:id="tfNom" promptText="Votre nom"/>
                        </VBox>

                        <VBox spacing="8">
                            <Label text="Prénom" styleClass="field-label"/>
                            <TextField fx:id="tfPrenom" promptText="Votre prénom"/>
                        </VBox>

                        <VBox spacing="8">
                            <Label text="Email" styleClass="field-label"/>
                            <TextField fx:id="tfEmail" promptText="Votre email"/>
                        </VBox>

                        <Separator styleClass="section-separator"/>

                        <!-- Section mot de passe -->
                        <Label text="Sécurité" styleClass="section-title"/>
                        
                        <VBox spacing="8">
                            <Label text="Mot de passe actuel" styleClass="field-label"/>
                            <PasswordField fx:id="tfOldPassword" promptText="Entrez votre mot de passe actuel"/>
                        </VBox>

                        <VBox spacing="8">
                            <Label text="Nouveau mot de passe" styleClass="field-label"/>
                            <PasswordField fx:id="tfNewPassword" promptText="Entrez votre nouveau mot de passe"/>
                        </VBox>

                        <!-- Boutons d'action -->
                        <HBox spacing="15" alignment="CENTER_RIGHT" styleClass="actions-container">
                            <Button fx:id="btnHistorique" onAction="#handleAfficherHistorique"
                                    styleClass="secondary-button">
                                <graphic>
                                    <ImageView fx:id="iconHistorique" fitWidth="18" fitHeight="18">
                                        <image>
                                            <Image url="@/assets/icons/historique.png"/>
                                        </image>
                                    </ImageView>
                                </graphic>
                            </Button>
                            <Button text="Enregistrer les modifications" 
                                    onAction="#handleSave" 
                                    styleClass="primary-button"/>
                        </HBox>
                    </VBox>
                </HBox>
            </StackPane>
        </VBox>
    </ScrollPane>
</AnchorPane>
