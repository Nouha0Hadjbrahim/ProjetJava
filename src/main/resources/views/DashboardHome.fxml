<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.effect.*?>
<?import javafx.scene.chart.PieChart?>

<ScrollPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.DashboardHomeController"
            fitToWidth="true"
            styleClass="main-scroll-pane"
            style="-fx-background: transparent; -fx-background-color: transparent;">

    <VBox spacing="40" alignment="CENTER" style="-fx-background-color: linear-gradient(to bottom right, #f8f9fa, #e9ecef);">
        <padding>
            <Insets top="20" right="40" bottom="40" left="40"/>
        </padding>

        <!-- Section principale avec HBox -->
        <HBox spacing="40" alignment="CENTER">
            <!-- Section gauche: Texte de bienvenue, météo et image -->
            <VBox spacing="30">
                <!-- En-tête avec texte de bienvenue -->
                <VBox spacing="5" styleClass="welcome-section">
                    <Label fx:id="welcomeLabel" styleClass="welcome-title"/>
                    <Label text="L'artisanat tunisien, entre vos mains" styleClass="welcome-subtitle"/>
                </VBox>

                <!-- Container pour la météo et le calendrier -->
                <HBox spacing="20" alignment="CENTER_LEFT" styleClass="info-container">
                    <!-- Météo -->
                    <VBox spacing="5" styleClass="weather-container">
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <StackPane styleClass="weather-icon-container">
                                <ImageView fx:id="weatherIcon" fitWidth="32" fitHeight="32" />
                            </StackPane>
                            <VBox spacing="2">
                                <Label fx:id="temperatureLabel" styleClass="temperature-label"/>
                                <Label fx:id="locationLabel" text="Ariana, Tunisie" styleClass="location-label"/>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Séparateur vertical -->
                    <Separator orientation="VERTICAL" styleClass="separator-style"/>

                    <!-- Calendrier -->
                    <VBox spacing="5" styleClass="calendar-container">
                        <Label fx:id="dateLabel" styleClass="date-label"/>
                        <Label fx:id="dayLabel" styleClass="day-label"/>
                    </VBox>

                    <Region HBox.hgrow="ALWAYS"/>

                    <!-- Image de poterie -->
                    <StackPane styleClass="pottery-container">
                        <ImageView fitWidth="130" fitHeight="130" preserveRatio="true" styleClass="pottery-image">
                            <image>
                                <Image url="@/assets/poterie.png"/>
                            </image>
                        </ImageView>
                    </StackPane>
                </HBox>

                <!-- Container pour l'image avec effet de profondeur -->
                <StackPane styleClass="image-container">
                    <effect>
                        <DropShadow radius="10" color="rgba(0,0,0,0.1)" offsetY="2"/>
                    </effect>
                    <ImageView fx:id="artisanatImage" fitWidth="600" fitHeight="500"
                               preserveRatio="true" styleClass="rounded-image"/>
                </StackPane>
            </VBox>

            <!-- Todo List à droite -->
            <VBox spacing="20" styleClass="todo-container">
                <effect>
                    <DropShadow radius="15" color="rgba(0,0,0,0.1)" offsetY="5"/>
                </effect>
                <padding>
                    <Insets top="30" right="25" bottom="25" left="25"/>
                </padding>

                <!-- En-tête Todo -->
                <VBox spacing="10" styleClass="todo-header">
                    <Label text="Ma Liste de Tâches" styleClass="todo-title"/>
                    <Label text="Gérez vos tâches quotidiennes" styleClass="todo-subtitle"/>
                </VBox>

                <!-- Zone de saisie avec style amélioré -->
                <HBox spacing="10" alignment="CENTER" styleClass="input-container">
                    <TextField fx:id="taskInput" promptText="Ajouter une nouvelle tâche..."
                               HBox.hgrow="ALWAYS"/>
                    <Button text="+" onAction="#handleAddTask" styleClass="add-button"/>
                </HBox>

                <!-- Liste des tâches avec défilement élégant -->
                <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="todo-scrollpane">
                    <VBox fx:id="todoList" spacing="8"/>
                </ScrollPane>
            </VBox>
        </HBox>

        <!-- Section Statistiques -->
        <HBox spacing="100" alignment="TOP_CENTER">

            <!-- Partie Gauche : Les graphiques -->
            <VBox spacing="40" alignment="CENTER_LEFT">

                <!-- Graphique Répartition Utilisateurs -->
                <VBox styleClass="stats-chart-container" alignment="CENTER" spacing="10">
                    <Label text="Répartition Des Status Des Utilisateurs (%)" styleClass="stats-title"/>
                    <StackPane fx:id="chartContainer" styleClass="chart-container">
                        <!-- Le PieChart sera ajouté dynamiquement -->
                    </StackPane>
                    <HBox spacing="0" alignment="CENTER" styleClass="chart-legend">
                        <HBox spacing="5" alignment="CENTER_LEFT">
                            <Region styleClass="legend-color-active"/>
                            <Label text="Actifs" styleClass="legend-label"/>
                        </HBox>
                        <HBox spacing="5" alignment="CENTER_LEFT">
                            <Region styleClass="legend-color-blocked"/>
                            <Label text="Bloqués" styleClass="legend-label"/>
                        </HBox>
                    </HBox>
                </VBox>

                <!-- Graphique Répartition Inscriptions Aux Ateliers -->
                <VBox styleClass="stats-chart-container" alignment="CENTER" spacing="10">
                    <Label text="Répartition des Inscriptions par Catégorie d'Atelier (%)" styleClass="stats-title"/>
                    <Label fx:id="totalInscriptionsLabel" text="Total: 0" styleClass="stats-value"/>
                    <StackPane styleClass="chart-container">
                        <PieChart fx:id="pieChartInscriptions" prefWidth="300" prefHeight="300"/>
                        <HBox fx:id="customLegend" spacing="20" alignment="CENTER"/>
                    </StackPane>
                </VBox>

            </VBox>

            <!-- Partie Droite : Cartes Totaux -->
            <VBox spacing="20" alignment="TOP_RIGHT">

                <!-- Carte Total Utilisateurs -->
                <StackPane styleClass="stats-card">
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <VBox>
                            <Label text="Total Utilisateurs" styleClass="stats-card-title"/>
                            <Label fx:id="totalUsersLabel" text="23" styleClass="stats-card-number"/>
                            <Label text="Nombre total d'utilisateurs enregistrés" styleClass="stats-card-subtitle"/>
                        </VBox>
                        <Region HBox.hgrow="ALWAYS"/>
                        <ImageView fitWidth="40" fitHeight="40">
                            <image>
                                <Image url="@/assets/icons/users.png"/>
                            </image>
                        </ImageView>
                    </HBox>
                </StackPane>

                <!-- Carte Total Artisans -->
                <StackPane styleClass="stats-card">
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <VBox>
                            <Label text="Total Artisans" styleClass="stats-card-title"/>
                            <Label fx:id="totalArtisansLabel" text="2" styleClass="stats-card-number"/>
                            <Label text="Nombre total d'artisans enregistrés" styleClass="stats-card-subtitle"/>
                        </VBox>
                        <Region HBox.hgrow="ALWAYS"/>
                        <ImageView fitWidth="40" fitHeight="40">
                            <image>
                                <Image url="@/assets/icons/artisans.png"/>
                            </image>
                        </ImageView>
                    </HBox>
                </StackPane>

                <!-- Carte Total Inscriptions -->
                <StackPane styleClass="stats-card">
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <VBox>
                            <Label text="Total Inscriptions" styleClass="stats-card-title"/>
                            <Label fx:id="totalInscriptionsCardLabel" text="0" styleClass="stats-card-number"/>
                            <Label text="Nombre total d'inscriptions aux ateliers" styleClass="stats-card-subtitle"/>
                        </VBox>
                        <Region HBox.hgrow="ALWAYS"/>
                        <ImageView fitWidth="40" fitHeight="40">
                            <image>
                                <Image url="@/assets/icons/artisans.png"/> <!-- Assure-toi que l'icône existe -->
                            </image>
                        </ImageView>
                    </HBox>
                </StackPane>


            </VBox>

        </HBox>
    </VBox>
</ScrollPane>
